<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Introduction · Gogeta.jl</title><meta name="title" content="Introduction · Gogeta.jl"/><meta property="og:title" content="Introduction · Gogeta.jl"/><meta property="twitter:title" content="Introduction · Gogeta.jl"/><meta name="description" content="Documentation for Gogeta.jl."/><meta property="og:description" content="Documentation for Gogeta.jl."/><meta property="twitter:description" content="Documentation for Gogeta.jl."/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>Gogeta.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Introduction</a><ul class="internal"><li><a class="tocitem" href="#Installation"><span>Installation</span></a></li><li><a class="tocitem" href="#Getting-started"><span>Getting started</span></a></li><li><a class="tocitem" href="#How-to-use?"><span>How to use?</span></a></li></ul></li><li><a class="tocitem" href="api/">Public API</a></li><li><a class="tocitem" href="reference/">Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Introduction</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Introduction</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/gamma-opt/Gogeta.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/gamma-opt/Gogeta.jl/blob/main/docs/src/index.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Gogeta.jl"><a class="docs-heading-anchor" href="#Gogeta.jl">Gogeta.jl</a><a id="Gogeta.jl-1"></a><a class="docs-heading-anchor-permalink" href="#Gogeta.jl" title="Permalink"></a></h1><p><a href="https://gamma-opt.github.io/Gogeta.jl/">Gogeta</a> is a package that enables the user to formulate machine-learning models as mathematical programming problems.</p><p>Currently supported models are <code>Flux.Chain</code> ReLU-activated neural networks and <code>EvoTrees</code> tree ensemble models.</p><h2 id="Installation"><a class="docs-heading-anchor" href="#Installation">Installation</a><a id="Installation-1"></a><a class="docs-heading-anchor-permalink" href="#Installation" title="Permalink"></a></h2><pre><code class="language-julia-repl hljs">julia&gt; Pkg.add(&quot;Gogeta&quot;)</code></pre><h2 id="Getting-started"><a class="docs-heading-anchor" href="#Getting-started">Getting started</a><a id="Getting-started-1"></a><a class="docs-heading-anchor-permalink" href="#Getting-started" title="Permalink"></a></h2><h3 id="Tree-ensembles"><a class="docs-heading-anchor" href="#Tree-ensembles">Tree ensembles</a><a id="Tree-ensembles-1"></a><a class="docs-heading-anchor-permalink" href="#Tree-ensembles" title="Permalink"></a></h3><p>First, one must create and train an <code>EvoTrees</code> tree ensemble model.</p><pre><code class="language-julia hljs">using EvoTrees

config = EvoTreeRegressor(nrounds=500, max_depth=5);
evo_model = fit_evotree(config; x_train, y_train);</code></pre><p>Then the parameters can be extracted from the trained tree ensemble and used to create a <code>JuMP</code> model containing the tree ensemble MIP formulation.</p><pre><code class="language-julia hljs">using Gurobi
using Gogeta

# Extract data from EvoTrees model

universal_tree_model = extract_evotrees_info(evo_model);

# Create JuMP model
opt_model = TE_to_MIP(universal_tree_model, Gurobi.Optimizer(), MIN_SENSE);</code></pre><p>There are two ways of optimizing the JuMP model: either by 1) creating the full set of split constraints before optimizing, or 2) using lazy constraints to generate only the necessary ones during the solution process.</p><pre><code class="language-julia hljs">optimize_with_lazy_constraints!(opt_model, universal_tree_model)</code></pre><pre><code class="language-julia hljs">optimize_with_initial_constraints!(opt_model, universal_tree_model)</code></pre><p>The optimal solution (minimum and maximum values for each of the input variables) can be queried after the optimization.</p><pre><code class="language-julia hljs">get_solution(opt_model, universal_tree_model)
objective_value(opt_model)</code></pre><h3 id="Neural-networks"><a class="docs-heading-anchor" href="#Neural-networks">Neural networks</a><a id="Neural-networks-1"></a><a class="docs-heading-anchor-permalink" href="#Neural-networks" title="Permalink"></a></h3><p>With neural networks, the hidden layers must use the <span>$ReLU$</span> activation function, and the output layer must use the identity activation.</p><p>These neural networks can be formulated into mixed-integer optimization problems.  Along with formulation, the neuron activation bounds can be calculated, which improves computational performance as well as enables compression.</p><p>The network is compressed by pruning neurons that are either stabily active or inactive. The activation bounds are used to identify these neurons.</p><p>First, create a neural network model satisfying the requirements:</p><pre><code class="language-julia hljs">using Flux

model = Chain(
    Dense(2 =&gt; 10, relu),
    Dense(10 =&gt; 20, relu),
    Dense(20 =&gt; 5, relu),
    Dense(5 =&gt; 1)
)</code></pre><p>Then define the bounds for the input variables. These will be used to calculate the activation bounds for the subsequent layers.</p><pre><code class="language-julia hljs">init_U = [-0.5, 0.5];
init_L = [-1.5, -0.5];</code></pre><p>One needs to provide parameters for the solver. In this case <code>Gurobi</code> solver is used with console logging off, default thread count, linear relaxation off and infinite time limit.</p><pre><code class="language-julia hljs">solver_params = SolverParams(solver=&quot;Gurobi&quot;, silent=true, threads=0, relax=false, time_limit=0);</code></pre><p>Then the neural network can be formulated into a MIP. Here bound tightening is also used.</p><pre><code class="language-julia hljs">nn_jump, U_correct, L_correct = NN_to_MIP_with_bound_tightening(model, init_U, init_L, solver_params; bound_tightening=&quot;standard&quot;);</code></pre><p>Using these bounds, the model can be compressed.</p><pre><code class="language-julia hljs">compressed, removed = compress_with_precomputed(model, init_U, init_L, U_correct, L_correct);</code></pre><p>Compression can also be done without precomputed bounds.</p><pre><code class="language-julia hljs">jump_model, compressed_model, removed_neurons, bounds_U, bounds_L = compress_with_bound_tightening(model, init_U, init_L,solver_params; bound_tightening=&quot;standard&quot;);</code></pre><p>Use the <code>JuMP</code> model to calculate a forward pass through the network (input at the center of the domain).</p><pre><code class="language-julia hljs">forward_pass!(jump_model, [-1.0, 0.0])</code></pre><h2 id="How-to-use?"><a class="docs-heading-anchor" href="#How-to-use?">How to use?</a><a id="How-to-use?-1"></a><a class="docs-heading-anchor-permalink" href="#How-to-use?" title="Permalink"></a></h2><p>Using the tree ensemble optimization from this package is quite straightforward. The only parameter the user can change is the solution method: with initial constraints or with lazy constraints. In our computational tests, we have seen that the lazy constraint generation almost invariably produces models that are computationally easier to solve.  Therefore we recommend primarily using it as the solution method, but depending on your use case, trying the initial constraints might also be worthwhile.</p><p>Conversely, the choice of the best neural network bound tightening and compression procedures depends heavily on your specific use case.  Based on some limited computational tests of our own as well knowledge from the field, we can make the following general recommendations:</p><ul><li>Wide but shallow neural networks should be preferred. The bound tightening gets exponentially harder with deeper layers.</li><li>For small neural network models, using the &quot;fast&quot; bound tightening option is probably the best, since the resulting formulations are easy to solve even with loose bounds.</li><li>For larger neural networks, &quot;standard&quot; bound tightening will produce tighter bounds but take more time. However, when using the <code>JuMP</code> model, the tighter bounds might make it more computationally feasible.</li><li>For large neural networks where the output bounds are known, &quot;output&quot; bound tightening can be used. This bound tightening is very slow but might be necessary to increase the computational feasibility of the resulting <code>JuMP</code> model.</li><li>If the model has many so-called &quot;dead&quot; neurons, creating the JuMP model by using compression is beneficial, since the formulation will have fewer constraints and the bound tightening will be faster, reducing total formulation time.</li></ul><p>These are only general recommendations based on limited evidence, and the user should validate the performance of each bound tightening and compression procedure in relation to her own work.</p></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="api/">Public API »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.1 on <span class="colophon-date" title="Wednesday 28 February 2024 09:51">Wednesday 28 February 2024</span>. Using Julia version 1.10.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
